var dash=function(t){var w=t.document?t.document.getElementsByTagName("script"):[],U=(w=w[w.length-1]||null)?w.src:null,m={},J={},w={},x=t.indexedDB||indexedDB,C=t.IDBKeyRange||IDBKeyRange,ca=t.DOMStringList||(self?Array:DOMStringList),K=null!==t.constructor.toString().match(/WorkerGlobalScope/),V=!!x.webkitGetDatabaseNames,da=!!self.Worker,A=function(a){var b={};if(L(a))return parseInt(a,10);if(z(a))return a.slice(0);u(a,function(a,d){!M(d)||q(d)||z(d)?b[a]=d:b[a]=A(d)});return b},n=function(a){return void 0!==
a&&null!==a&&""!==a&&(!z(a)||0<a.length)?!1:!0},f=function(a,b,c,d){if(q(a))return a.apply(c||{},b||[]);if(q(d))return f(d,[])},e=function(a){return n(a)?!1:!0},W=function(a,b){return b===a},X=function(a){var b={};p(y,function(c){e(a[c])&&(b[c]=a[c])});return b},z=function(a){var b=!1;if(a instanceof Array||a instanceof ca)b=!0;return b},Y=function(a){return"boolean"===typeof a||"true"===a||"false"===a?!0:!1},q=function(a){return"function"===typeof a},M=function(a){return null!==a&&"object"===typeof a&&
"[object Object]"===a.toString()},L=function(a){var b;(b="number"===typeof a)||(b=void 0===isNaN(parseInt(a,10),!1));return b?!0:!1},Z=function(a){return"string"===typeof a},p=function(a,b,c){var d,g=a.length;c=c||1;for(d=0;d<g;d+=c)f(b,[a[d],d])},u=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])},B=function(){var a=!1,b=null,c=[],d=[],g=[],e=[],l=[];return{promise:function(h,D,ea){var fa=B();d.push(B);!0===a?f(b?h:D,c):p([[e,h],[l,D],[g,ea]],function(a){var c=a[1];q(c)&&a[0].push(c)});
return fa.promise},resolve:function(){var g=arguments;!1===a&&(a=b=!0,c=g,p(e,function(a){f(a,g)}),p(d,function(a){f(a.resolve,g)}))},notify:function(){var a=arguments;p(g,function(c){f(c,a)});p(d,function(c){f(c.notify,a)})},reject:function(){var g=arguments;!1===a&&(b=!1,a=!0,c=g,p(l,function(a){f(a,g)}))}}},s=function(a,b,c){var d=!1;e(a)&&u(a,function(a,e){if(!0===c&&b===a||b===e)d=!0});return d},N="on_success on_error on_abort on_blocked on_upgrade_needed on_close on_complete".split(" "),$="amount db entry entries idx indexes key last_entry last_key last_primary_key new_version objectstore old_version stores value".split(" "),
y="auto_increment callback data database databases direction duplicates index index_key_path index_multi_entry index_unique key_path limit multi_entry primary_key skip store store_key_path unique version".split(" "),O="database store version store_key_path unique multi_entry data auto_increment on_complete on_error on_success on_abort key index index_key_path index_multi_entry index_unique limit skip".split(" "),H=function(a){var b={};p(O,function(c){e(a[c])&&(b[c]=a[c])});return b},aa=function(a){var b=
function(a){!1===s(y,a)&&y.push(a);!1===s(O,a)&&O.push(a)};z(a)?p(a,function(a){b(a)}):b(a)},F=function(a,b){var c={},d=function(a){var c=[];p(a,function(a){c.push(a)});return c};p(y,function(b){e(a[b])&&(c[b]="db"===b?P({name:a[b].name,version:a[b].version,objectStoreNames:d(a[b].objectStoreNames)},"database",a):"objectstore"===b?P({name:a[b].name,indexNames:d(a[b].indexNames),autoIncrement:a[b].autoIncrement,keyPath:a[b].keyPath},"store",a):"idx"===b?P({name:a[b].name,multiEntry:a[b].multiEntry,
unique:a[b].unique,keyPath:a[b].keyPath},"index",a):"indexes"===b||"stores"===b||"databases"===b?d(a[b]):a[b])});W(ba(b),"versionchange")&&ga(a);return c},ba=function(a){return s(["add.index","remove.index","add.store","remove.store"],a)?"versionchange":s(["get.entry","get.entries"],a)?"readonly":"readwrite"},Q=function(a,b){var c=function(c){a.event=c;return a},d,g=0,v=a.limit,l=a.skip;a.direction=a.direction||e(a)&&!1===a.duplicates?"nextunique":"next";a.range=a.range||J.get(a);e(a.data)&&(a.data=
q(a.data)?a.data():A(a.data));n(a.transaction)&&(a.db=a.event.target.result,a.transaction=a.db.transaction([a.store],a.type));n(a.objectstore)&&(a.objectstore=a.transaction.objectStore(a.store));n(a.idx)&&!n(a.index)&&(a.idx=a.objectstore.index(a.index));d=n(a.index)?a.objectstore.openCursor(a.range,a.direction):a.idx.openCursor(a.range,a.direction);a.amount=a.amount||0;d.transaction.addEventListener("complete",function(b){a.cursor=d.result;a=c(b);a.last_key=a.key;delete a.key;a.last_primary_key=
a.primary_key;delete a.primary_key;a.last_entry=a.entry;delete a.entry;delete a.direction;a.last_entry instanceof IDBOpenDBRequest&&delete a.last_entry;a.db.close();complete(a)});d.transaction.addEventListener("error",function(b){a.error=b;a=c(b);error(a)});d.addEventListener("success",function(h){a.cursor=d.result;e(a.cursor)&&(a.primary_key=a.cursor.primaryKey,a.key=a.cursor.key,a.direction=a.cursor.direction);a=c(h);n(l)?(n(v)||g++<v)&&f(b,[a]):(e(a.cursor.advance)&&a.cursor.advance(l),l=null)})},
I={},ha=function(a,b,c,d,g,e){for(var l=0,h=[],D=function(c){var b=c.data;if(void 0!==I[b.uid])switch(c.data.type){case "success":delete I[b.uid];a.removeEventListener("message",D);f(d,[b.context]);break;case "error":delete I[b.uid];a.removeEventListener("message",D);f(g,[b.context]);break;case "notify":f(e,[b.context])}},l=0;16>l;l+=1)h.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(100*Math.random())%62]);l=h.join("");I[l]={success:d,error:g,notify:e};a.addEventListener("message",
D);a.postMessage({dash:b,context:c,uid:l});return l},ia=function(a,b){var c=B(),d={on_success:b.on_success,on_error:b.on_error,on_abort:b.on_abort,on_complete:b.on_complete,on_upgrade_needed:b.on_upgrade_needed,on_blocked:b.on_blocked,on_close:b.on_close},g=new Worker(U),e=function(a){u(d,function(c,b){a[c]=b});return a};u(d,function(a,c){delete b[a]});ha(g,a,b,function(a){c.resolve(e(a))},function(a){c.reject(e(a))},function(a){c.notify(e(a))});return c.promise},k={},ja=function(a){var b={database:!1,
store:!1,index:!1};e(k[a.database])&&e(k[a.database].data)&&(b.database=!0,e(k[a.database].stores[a.store])&&e(k[a.database].stores[a.store].data)&&(b.store=!0,e(k[a.database].stores[a.store].indexes[a.index])&&e(k[a.database].stores[a.store].indexes[a.index].data)&&(b.index=!0)));return b},P=function(a,b,c){if(e(c)&&e(c.database)){k[c.database]=k[c.database]||{stores:{},data:null};if("database"===b)return k[c.database].data=a;if(e(c.store)){k[c.database].stores[c.store]=k[c.database].stores[c.store]||
{indexes:{},data:null};if("store"===b)return k[c.database].stores[c.store].data=a;e(c.index)&&(k[c.database].stores[c.store].indexes[c.index]=k[c.database].stores[c.store].indexes[c.index]||{data:null},"index"===b&&(k[c.database].stores[c.store].indexes[c.index].data=a))}}return a},ga=function(a){delete k[a.database];return a},ka=function(a,b,c){var d=ba(c),g=function(a,c){var b=H(a);if(n(a.database))return f(c,[a]);b.on_success=function(a){a.on_success=null;a.version=a.db.version;a.db.close();f(c,
[a])};b.on_upgrade_needed=function(a){a.upgraded=!0;a.version=a.new_version;a.on_upgrade_needed=null;a.transaction.oncomplete=function(){a.db.close();f(c,[a])}};m.get(b)},v=function(a,b){var g=H(a);if(n(a.store)||s(["add.store"],c))return f(b,[a]);g.on_success=function(a){a.on_success=null;a.db=a.request.result;a.db.objectStoreNames.contains(a.store)?(null!==a.transaction&&(a.objectstore=a.transaction.objectStore([a.store],d)),a.db.close(),f(b,[a])):(a.version=a.db.version+1,a.on_success=null,a.on_upgrade_needed=
function(a){a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.db.close();f(b,[a])});a.objectstore=a.db.createObjectStore(a.store,{keyPath:Z(a.store_key_path)?a.store_key_path:null,autoIncrement:Y(a.auto_increment)?a.auto_increment:!1})},m.get(a))};g.version=null;m.get(g)},l=function(a,b){var d=H(a);if(n(a.store)||n(a.index)||s("add.store get.store remove.store get.stores remove.stores remove.index add.index".split(" "),c))return f(b,[a]);d.on_success=function(c){c.on_success=
null;c.db=c.request.result;c.objectstore=c.db.transaction([c.store],"readonly").objectStore(c.store);c.transaction=c.objectstore.transaction;c.objectstore.indexNames.contains(a.index)?(c.db.close(),f(b,[c])):(c.version=c.db.version+1,c.on_success=null,c.on_upgrade_needed=function(a){a.objectstore=a.transaction.objectStore([a.store]);a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.on_success=null;f(b,[a]);a.db.close()});a.on_success=null;a.idx=a.objectstore.createIndex(a.index,
a.index_key_path,{unique:a.index_unique||!1,multiEntry:a.index_multi_entry||!1})},c.db.close(),m.get(c))};m.get(d)},h=function(b){var g=b.on_success,h=b.on_complete,l=b.on_error,r=H(b),v=function(b){e(b.store)&&"versionchange"!==d?(null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),b.objectstore=b.transaction.objectStore(b.store),b.transaction.addEventListener("complete",function(){b.db.close()})):e(b.store)&&(b.db=b.request.result,b.transaction=b.request.transaction,null===b.transaction&&
(b.transaction=b.db.transaction([b.store],d)),s(["add.store","remove.store"],c)||(b.objectstore=b.transaction.objectStore(b.store)),b.transaction.addEventListener("complete",function(){b.db.close()}));b.on_success=function(a){a=F(a,c);a.on_success=g;success(a)};b.on_complete=function(a){a=F(a,c);a.on_complete=h;f(a.on_complete,[a])};b.on_error=function(a){a=F(a,c);a.on_error=l;error(a)};f(a,[b])};r.version=b.version;if(s(["get.databases","remove.database","get.database"],c))return f(a,[F(b,c)]);"versionchange"!==
d?(r.on_success=v,r.on_upgrade_needed=null):(r.version=b.db.version+1,r.on_upgrade_needed=v,r.on_success=null);r.on_complete=null;m.get(r)};b=X(b);b.type=d;(function(a){if(e(a)){var b=a?a.on_upgrade_needed:void 0,d=a?a.on_success:void 0,f=ja(a);if(s(["get.database","remove.database"],c)||!0===f.database&&!0===f.store&&!0===f.index)return h(a);a.on_success=null;a.on_upgrade_needed=null;!1===f.database?g(a,function(a){v(a,function(a){l(a,function(a){a.on_success=d;a.on_upgrade_needed=b;h(a)})})}):!1===
f.store?v(a,function(a){l(a,function(a){a.on_success=d;a.on_upgrade_needed=b;h(a)})}):l(a,function(a){a.on_success=d;a.on_upgrade_needed=b;h(a)})}})(b)},R=[],S=[],T={clone:A,contains:s,deferred:B,exists:e,is:W,isEmpty:n,isnt:function(a,b){return b!==a},isArray:z,isBoolan:Y,isRegEx:function(a){return q(a.constructor)&&null!==a.constructor.toString().match(/RegExp/)},isFunction:q,isObject:M,isNumber:L,isString:Z,apply:f,each:p,iterate:u,api:G},la=function(a,b){return function(c){c=c||{};var d={};p(N,
function(a){d[a.replace(/^on_/,"")]=c[a]});!0===K&&u(c,function(a){!0===s($,a)?delete c[a]:aa(a)});return function(a,c,d,h){var k=B(),m=0,t=s(["get.entries","update.entries","remove.entries"],b),w={success:"s",error:"e",abort:"a",complete:"c",upgrade_needed:"u",blocked:"b",closed:"l"},r,y=k.promise;u(c,function(b){a["on_"+b]=function(a,b,c){return function(d){M(d)&&u(b,function(a,b){var c="on_"+a;q(b)?d[c]=b:delete d[c]});d=X(d);var e,g,h,l=0,v=B(),m=v.promise;e="s"===a&&!0===t?"notify":"e"===a||
"a"===a||"b"===a?"reject":"resolve";g=F(d,c);p(S,function(a){h=f(a,[{type:e,method:c,context:g,priority:++l,promise:m}],A(T));g=h.context;m=h.promise||m;s(["reject","resolve"],e)&&(e=h.type)});m(function(a){n(a.type)||f(k[a.type],[a.context],k)},function(a){f(k.error,[a.context],k)});v.resolve(A({method:c,type:e,context:g}))}}(w[b],c,h)});if(null!==h.match(/\.behavior/))f(d,[a]);else try{var z=B(),E=z.promise,x={};T.api=G;p(R,function(b){r=f(b,[{type:null,method:h,context:a,priority:++m,promise:E}],
A(T));a=r.context||a;u(a,function(a){aa(a)});h=r.type||h;E=r.promise||E});E(function(b){!0===t&&!0!==K&&!0===V&&e(U)&&!0===da?(u({on_success:b.context.on_success,on_error:b.context.on_error,on_abort:b.context.on_abort,on_complete:b.context.on_complete,on_upgrade_needed:b.context.on_upgrade_needed,on_blocked:b.context.on_blocked,on_close:b.context.on_close},function(b,c){x[b]=a[b];a[b]=c}),E=ia(h,a),E(function(a){f(x.on_complete,[a])},function(a){f(x.on_error,[a])},function(a){f(x.on_success,[a])})):
ka(d,a,b.method)},function(b){a.error=b.error;error(a)});z.resolve(A({method:h,type:null,context:a}))}catch(C){a.error=C,error(a)}return y}(c,d,a,b)}},ma=self,G;y.push.apply(y,N);y.push.apply(y,$);p(N,function(a){ma[a.replace(/^on_/g,"")]=function(b){f(b[a],[b]);return b}});m.close=function(a,b){a.db.close();!0!==b&&success(a)};m.remove=function(a,b){x.deleteDatabase(a.database);!0!==b&&success(a)};m.get=function(a){var b=a.on_upgrade_needed,c=a.on_success,d=a.on_blocked,g=!1,k=function(a,b){b.event=
a;b.transaction=b.request?b.request.transaction:a.target.transaction;e(b.transaction)&&e(b.transaction.db)&&(b.db=b.transaction.db);e(a.newVersion)?(b.new_version=a.newVersion,b.old_version=a.oldVersion,b.upgrade=b.new_version!==b.old_version?!0:!1):b.upgrade=!1;return b};a.request=L(a.version)?x.open(a.database,a.version):x.open(a.database);a.db&&a.db.close();a.request.addEventListener("success",function(b){g||(a=k(b,a),a.upgrade=!1,a.opened=!0,a.on_success=c,a.db=a.event.target.result,success(a))});
a.request.addEventListener("upgradeneeded",function(c){g=!0;a=k(c,a);a.upgrade=!0;a.opened=!0;a.on_upgrade_needed=b;upgrade_needed(a)});a.request.addEventListener("blocked",function(b){a=k(b,a);f(d,[a])})};J.get=function(a){var b=null,c=a.left_bound,d=a.right_bound,g=a.includes_left_bound,f=a.includes_right_bound;e(c)&&e(d)&&e(g)&&e(f)?b=C.bound(c,d,g,f):e(c)&&e(g)?b=C.lowerBound(c,g):e(d)&&e(f)?b=C.upperBound(d,f):e(a.value)&&(b=C.only(a.value));a.result=b;success(a);return b};w.add=function(a){z(a)?
(q(a[0])&&R.push(a[0]),q(a[1])&&S.push(a[1])):q(a)&&(R.push(a),S.push(a))};G=function(a){var b={},c=[],d;u(a,function(a,e){c=a.split(".");d=c[0];b[d]=b[d]||{};b[d][c[1]]=la(e,a)});return b}({"add.entry":function(a){var b;a.data=q(a.data)?a.data():A(a.data);b=a.objectstore.add(a.data);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.key=b.result;success(a)})},"add.behavior":w.add,"count.entries":function(a){var b;
e(a.index)?(a.idx=a.objectstore.index(a.index),b=n(a.key)?a.idx.count():a.idx.count(a.key)):b=n(a.key)?a.objectstore.count():a.objectstore.count(a.key);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.total=b.result;success(a)})},"get.database":m.get,"get.databases":function(a){var b=a.on_success;if(!1===V)return error(a);a.request=x.webkitGetDatabaseNames();a.request.addEventListener("success",function(c){a.databases=
c.target.result;a.on_success=b;success(a)})},"get.store":function(a){success(a)},"get.stores":function(a){a.stores=a.db.objectStoreNames;success(a)},"get.index":function(a){a.idx=a.objectstore.index(a.index);success(a)},"get.indexes":function(a){a.indexes=a.objectstore.indexNames;success(a)},"get.entry":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),b=!1===a.value?a.idx.getKey(a.key):a.idx.get(a.key)):b=a.objectstore.get(a.key);a.transaction.addEventListener("error",function(b){a.error=
b.target.error.message;error(a)});b.addEventListener("success",function(){a.entry=b.result;success(a)})},"get.entries":function(a){a.type="readonly";var b=a.on_success;a.on_success=null;Q(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"get.behaviors":w.get,"update.entries":function(a){a.type="readwrite";var b=a.on_success;Q(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,
a.amount=a.amount||0,a.amount+=1,a.cursor.update(a.data),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"put.entry":function(a){var b;a.data=q(a.data)?a.data():A(a.data);b=e(a.key)?a.objectstore.put(a.data,a.key):a.objectstore.put(a.data);a.transaction.addEventListener("complete",function(){a.key=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)})},"clear.store":function(a){a.objectstore.clear();success(a)},"remove.database":m.remove,
"remove.store":function(a){a.db.deleteObjectStore(a.store);success(a)},"remove.index":function(a){a.objectstore.deleteIndex(a.index);success(a)},"remove.entry":function(a){var b,c=e(a.range)||e(a.upper)||e(a.lower)||e(a.only);b=a.objectstore["delete"](c?a.range||J.get(a):a.key);a.transaction.addEventListener("complete",function(){a.entry=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)})},"remove.entries":function(a){a.type="readwrite";
var b=a.on_success;Q(a,function(a){a.entry=a.request;if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor["delete"](),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})}});!0===K&&t.addEventListener("message",function(a){var b=a.data,c=b.dash.split(".");a=c[0];var c=c[1],d=function(a){b.context=a;t.postMessage(b)};void 0!==dash[a]&&void 0!==dash[a][c]?G[a][c](b.context)(function(a){b.type="success";d(a)},function(a){b.type="error";d(a)},function(a){b.type=
"notify";d(a)}):(b.type="error",d({error:"No such method"}))},!1);return G}(self||{});