var dash=function(u){var l={},B={},G={},y=u.indexedDB||indexedDB,z=u.IDBKeyRange||IDBKeyRange,S=u.DOMStringList||(self?Array:DOMStringList),x=function(a){var b={};if(H(a))return parseInt(a,10);if(v(a))return a.slice(0);w(a,function(a,d){!E(d)||p(d)||v(d)?b[a]=d:b[a]=x(d)});return b},h=function(a){return void 0!==a&&null!==a&&""!==a&&(!v(a)||0<a.length)?!1:!0},g=function(a,b,c,d){if(p(a))return a.apply(c||{},b||[]);if(p(d))return g(d,[])},e=function(a){return h(a)?!1:!0},F=function(a,b,c){a=a||{};
w(x(b),function(b,f){!0===c&&E(f)?a[b]=F({},f,c):a[b]=f});return a},O=function(a){var b={};m(n,function(c){e(a[c])&&(b[c]=a[c])});return b},v=function(a){var b=!1;if(a instanceof Array||a instanceof S)b=!0;return b},P=function(a){return"boolean"===typeof a||"true"===a||"false"===a?!0:!1},p=function(a){return"function"===typeof a},E=function(a){return null!==a&&"object"===typeof a&&"[object Object]"===a.toString()},H=function(a){var b;(b="number"===typeof a)||(b=void 0===isNaN(parseInt(a,10),!1));
return b?!0:!1},Q=function(a){return"string"===typeof a},m=function(a,b,c){var d,f=a.length;c=c||1;for(d=0;d<f;d+=c)g(b,[a[d],d])},w=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])},A=function(){var a=!1,b=null,c=[],d=[],f=[],e=[],r=[];return{promise:function(q,R,T){var U=A();d.push(A);!0===a?g(b?q:R,c):m([[e,q],[r,R],[f,T]],function(a){var c=a[1];p(c)&&a[0].push(c)});return U.promise},resolve:function(){var f=arguments;!1===a&&(a=b=!0,c=f,m(e,function(a){g(a,f)}),m(d,function(a){g(a.resolve,
f)}))},notify:function(){var a=arguments;m(f,function(c){g(c,a)});m(d,function(c){g(c.notify,a)})},reject:function(){var d=arguments;!1===a&&(b=!1,a=!0,c=d,m(r,function(a){g(a,d)}))}}},s=function(a,b,c){var d=!1;e(a)&&w(a,function(a,e){if(!0===c&&b===a||b===e)d=!0});return d},I="on_success on_error on_abort on_blocked on_upgrade_needed on_close on_complete".split(" "),n="amount auto_increment callback data database databases db direction duplicates entries entry idx index index_key_path index_multi_entry index_unique indexes key key_path last_entry last_key last_primary_key limit match map multi_entry new_version objectstore old_version primary_key skip store store_key_path stores total throttle type unique value version".split(" "),
J="database store version store_key_path unique multi_entry data auto_increment on_complete on_error on_success on_abort key index index_key_path index_multi_entry index_unique limit skip".split(" "),t=function(a){var b={};m(J,function(c){e(a[c])&&(b[c]=a[c])});return b},V=function(a){var b=function(a){!1===s(n,a)&&n.push(a);!1===s(J,a)&&J.push(a)};v(a)?m(a,function(a){b(a)}):b(a)},C=function(a){var b={},c=function(a){var c=[];m(a,function(a){c.push(a)});return c};m(n,function(d){e(a[d])&&(b[d]="db"===
d?{name:a[d].name,version:a[d].version,objectStoreNames:c(a[d].objectStoreNames)}:"objectstore"===d?{name:a[d].name,indexNames:c(a[d].indexNames),autoIncrement:a[d].autoIncrement,keyPath:a[d].keyPath}:"idx"===d?{name:a[d].name,multiEntry:a[d].multiEntry,unique:a[d].unique,keyPath:a[d].keyPath}:"indexes"===d||"stores"===d||"databases"===d?c(a[d]):a[d])});return b},W=function(a){return s(["add.index","remove.index","add.store","remove.store"],a)?"versionchange":s(["get.entry","get.entries"],a)?"readonly":
"readwrite"},K=function(a,b){var c=function(c){a.event=c;return a},d,f=0,k=a.limit,r=a.skip;a.direction=a.direction||e(a)&&!1===a.duplicates?"nextunique":"next";a.range=a.range||B.get(a);e(a.data)&&(a.data=p(a.data)?a.data():x(a.data));h(a.transaction)&&(a.db=a.event.target.result,a.transaction=a.db.transaction([a.store],a.type));h(a.objectstore)&&(a.objectstore=a.transaction.objectStore(a.store));h(a.idx)&&!h(a.index)&&(a.idx=a.objectstore.index(a.index));d=h(a.index)?a.objectstore.openCursor(a.range,
a.direction):a.idx.openCursor(a.range,a.direction);a.amount=a.amount||0;d.transaction.addEventListener("complete",function(b){a.cursor=d.result;a=c(b);a.last_key=a.key;delete a.key;a.last_primary_key=a.primary_key;delete a.primary_key;a.last_entry=a.entry;delete a.entry;delete a.direction;a.db.close();complete(a)});d.transaction.addEventListener("error",function(b){a.error=b;a=c(b);error(a)});d.addEventListener("success",function(q){a.cursor=d.result;e(a.cursor)&&(a.primary_key=a.cursor.primaryKey,
a.key=a.cursor.key,a.direction=a.cursor.direction);a=c(q);h(r)?(h(k)||f++<k)&&g(b,[a]):(e(a.cursor.advance)&&a.cursor.advance(r),r=null)})},X=function(a,b,c){var d=W(c),f=function(a,c){var b=t(a);if(h(a.database))return g(c,[a]);b.on_success=function(a){a.on_success=null;a.version=a.db.version;a.db.close();g(c,[a])};b.on_upgrade_needed=function(a){a.upgraded=!0;a.version=a.new_version;a.on_upgrade_needed=null;a.transaction.oncomplete=function(){a.db.close();g(c,[a])}};l.get(b)},k=function(a,b){var f=
t(a);if(h(a.store)||s(["add.store"],c))return g(b,[a]);f.on_success=function(a){a.on_success=null;a.db=a.request.result;a.db.objectStoreNames.contains(a.store)?(null!==a.transaction&&(a.objectstore=a.transaction.objectStore([a.store],d)),a.db.close(),g(b,[a])):(a.version=a.db.version+1,a.on_success=null,a.on_upgrade_needed=function(a){a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.db.close();g(b,[a])});a.objectstore=a.db.createObjectStore(a.store,{keyPath:Q(a.store_key_path)?
a.store_key_path:null,autoIncrement:P(a.auto_increment)?a.auto_increment:!1})},l.get(a))};f.version=null;l.get(f)},r=function(a,b){var d=t(a);if(h(a.store)||h(a.index)||s("add.store get.store remove.store get.stores remove.stores remove.index add.index".split(" "),c))return g(b,[a]);d.on_success=function(c){c.on_success=null;c.db=c.request.result;c.objectstore=c.db.transaction([c.store],"readonly").objectStore(c.store);c.transaction=c.objectstore.transaction;c.objectstore.indexNames.contains(a.index)?
(c.db.close(),g(b,[c])):(c.version=c.db.version+1,c.on_success=null,c.on_upgrade_needed=function(a){a.objectstore=a.transaction.objectStore([a.store]);a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.on_success=null;g(b,[a]);a.db.close()});a.on_success=null;a.idx=a.objectstore.createIndex(a.index,a.index_key_path,{unique:a.index_unique||!1,multiEntry:a.index_multi_entry||!1})},c.db.close(),l.get(c))};l.get(d)},q=function(b){var f=b.on_success,q=b.on_complete,r=b.on_error,
k=t(b),h=function(b){e(b.store)&&"versionchange"!==d?(null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),b.objectstore=b.transaction.objectStore(b.store),b.transaction.addEventListener("complete",function(){b.db.close()})):e(b.store)&&(b.db=b.request.result,b.transaction=b.request.transaction,null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),s(["add.store","remove.store"],c)||(b.objectstore=b.transaction.objectStore(b.store)),b.transaction.addEventListener("complete",
function(){b.db.close()}));b.on_success=function(a){a=C(a);a.on_success=f;success(a)};b.on_complete=function(a){a=C(a);a.on_complete=q;g(a.on_complete,[a])};b.on_error=function(a){a=C(a);a.on_error=r;error(a)};g(a,[b])};k.version=b.version;if(s(["get.databases","remove.database","get.database"],c))return g(a,[C(b)]);"versionchange"!==d?(k.on_success=h,k.on_upgrade_needed=null):(k.version=b.db.version+1,k.on_upgrade_needed=h,k.on_success=null);k.on_complete=null;l.get(k)};b=O(b);b.type=d;(function(a){if(e(a)){var b=
a?a.on_upgrade_needed:void 0,d=a?a.on_success:void 0;if(s(["get.database","remove.database"],c))return q(a);a.on_success=null;a.on_upgrade_needed=null;f(a,function(a){k(a,function(a){r(a,function(a){a.on_success=d;a.on_upgrade_needed=b;q(a)})})})}})(b)},L=[],M=[],N={clone:x,contains:s,deferred:A,exists:e,extend:F,is:function(a,b){return b===a},isEmpty:h,isnt:function(a,b){return b!==a},isArray:v,isBoolan:P,isRegEx:function(a){return p(a.constructor)&&null!==a.constructor.toString().match(/RegExp/)},
isFunction:p,isObject:E,isNumber:H,isString:Q,apply:g,each:m,iterate:w,api:D},Y=function(a,b){return function(c){c=c||{};var d={};m(I,function(a){d[a.replace(/^on_/,"")]=c[a]});return function(a,c,d,e){var l=A(),u=0,v=s(["get.entries","update.entries","remove.entries"],b),x={success:"s",error:"e",abort:"a",complete:"c",upgrade_needed:"u",blocked:"b",closed:"l"},n,y=l.promise;w(c,function(b){a["on_"+b]=function(a,b,c){return function(d){E(d)&&w(b,function(a,b){var c="on_"+a;p(b)?d[c]=b:delete d[c]});
d=O(d);var e,f,q,k=0,r=A(),n=r.promise;e="s"===a&&!0===v?"notify":"e"===a||"a"===a||"b"===a?"reject":"resolve";f=C(d);m(M,function(a){q=g(a,[{type:e,method:c,context:f,priority:++k,promise:n}],F({},N));f=q.context;n=q.promise||n;s(["reject","resolve"],e)&&(e=q.type)});n(function(a){h(a.type)||g(l[a.type],[a.context],l)},function(a){g(l.error,[a.context],l)});r.resolve({method:c,type:e,context:f})}}(x[b],c,e)});if(null!==e.match(/\.behavior/))g(d,[a]);else try{var z=A(),t=z.promise;N.api=D;m(L,function(b){n=
g(b,[{type:null,method:e,context:a,priority:++u,promise:t}],F({},N));a=n.context;w(a,function(a){V(a)});e=n.type;t=n.promise||t});t(function(a){X(d,a.context,a.method)},function(b){a.error=b.error;error(a)});z.resolve({method:e,type:null,context:a})}catch(B){a.error=B,error(a)}return y}(c,d,a,b)}},Z=self,D;n.push.apply(n,I);m(I,function(a){Z[a.replace(/^on_/g,"")]=function(b){g(b[a],[b]);return b}});l.close=function(a,b){a.db.close();!0!==b&&success(a)};l.remove=function(a,b){y.deleteDatabase(a.database);
!0!==b&&success(a)};l.get=function(a){var b=a.on_upgrade_needed,c=a.on_success,d=a.on_blocked,f=!1,k=function(a,b){b.event=a;b.transaction=b.request?b.request.transaction:a.target.transaction;e(b.transaction)&&e(b.transaction.db)&&(b.db=b.transaction.db);e(a.newVersion)?(b.new_version=a.newVersion,b.old_version=a.oldVersion,b.upgrade=b.new_version!==b.old_version?!0:!1):b.upgrade=!1;return b};a.request=H(a.version)?y.open(a.database,a.version):y.open(a.database);a.db&&a.db.close();a.request.addEventListener("success",
function(b){f||(a=k(b,a),a.upgrade=!1,a.opened=!0,a.on_success=c,a.db=a.event.target.result,success(a))});a.request.addEventListener("upgradeneeded",function(c){f=!0;a=k(c,a);a.upgrade=!0;a.opened=!0;a.on_upgrade_needed=b;upgrade_needed(a)});a.request.addEventListener("blocked",function(b){a=k(b,a);g(d,[a])})};B.get=function(a){var b=null,c=a.left_bound,d=a.right_bound,f=a.includes_left_bound,g=a.includes_right_bound;e(c)&&e(d)&&e(f)&&e(g)?b=z.bound(c,d,f,g):e(c)&&e(f)?b=z.lowerBound(c,f):e(d)&&e(g)?
b=z.upperBound(d,g):e(a.value)&&(b=z.only(a.value));a.result=b;success(a);return b};G.add=function(a){v(a)?(p(a[0])&&L.push(a[0]),p(a[1])&&M.push(a[1])):p(a)&&(L.push(a),M.push(a))};D=function(a){var b={},c=[],d;w(a,function(a,e){c=a.split(".");d=c[0];b[d]=b[d]||{};b[d][c[1]]=Y(e,a)});return b}({"add.entry":function(a){var b;a.data=p(a.data)?a.data():x(a.data);b=a.objectstore.add(a.data);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",
function(){a.key=b.result;success(a)})},"add.behavior":G.add,"count.entries":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),b=h(a.key)?a.idx.count():a.idx.count(a.key)):b=h(a.key)?a.objectstore.count():a.objectstore.count(a.key);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.total=b.result;success(a)})},"get.database":l.get,"get.databases":function(a){var b=a.on_success;if(!p(y.webkitGetDatabaseNames))return error(a);
a.request=y.webkitGetDatabaseNames();a.request.addEventListener("success",function(c){a.databases=c.target.result;a.on_success=b;success(a)})},"get.store":function(a){success(a)},"get.stores":function(a){a.stores=a.db.objectStoreNames;success(a)},"get.index":function(a){a.idx=a.objectstore.index(a.index);success(a)},"get.indexes":function(a){a.indexes=a.objectstore.indexNames;success(a)},"get.entry":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),b=!1===a.value?a.idx.getKey(a.key):
a.idx.get(a.key)):b=a.objectstore.get(a.key);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.entry=b.result;success(a)})},"get.entries":function(a){a.type="readonly";var b=a.on_success;a.on_success=null;K(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"get.behaviors":G.get,"update.entries":function(a){a.type=
"readwrite";var b=a.on_success;K(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor.update(a.data),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"put.entry":function(a){var b;a.data=p(a.data)?a.data():x(a.data);b=e(a.key)?a.objectstore.put(a.data,a.key):a.objectstore.put(a.data);a.transaction.addEventListener("complete",function(){a.key=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;
error(a)})},"clear.store":function(a){a.objectstore.clear();success(a)},"remove.database":l.remove,"remove.store":function(a){a.db.deleteObjectStore(a.store);success(a)},"remove.index":function(a){a.objectstore.deleteIndex(a.index);success(a)},"remove.entry":function(a){var b,c=e(a.range)||e(a.upper)||e(a.lower)||e(a.only);b=a.objectstore["delete"](c?a.range||B.get(a):a.key);a.transaction.addEventListener("complete",function(){a.entry=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=
b.target.error.message;error(a)})},"remove.entries":function(a){a.type="readwrite";var b=a.on_success;K(a,function(a){a.entry=a.request;if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor["delete"](),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})}});null!==u.constructor.toString().match(/WorkerGlobalScope/)&&u.addEventListener("message",function(a){var b=a.data,c=b.dash.split(".");a=c[0];var c=c[1],d=function(a){b.context=a;u.postMessage(b)};
void 0!==dash[a]&&void 0!==dash[a][c]?D[a][c](b.context)(function(a){b.type="success";d(a)},function(a){b.type="error";d(a)},function(a){b.type="notify";d(a)}):(b.type="error",d({error:"No such method"}))},!1);return D}(self||{});