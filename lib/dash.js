var dash=function(x){var u=x.document?x.document.getElementsByTagName("script"):[],u=u[u.length-1]||null,U=null!==u&&null===u.src.match(/chrome-extension/)?u.src:null,n={},G,J={},K={},v=x.indexedDB||indexedDB,A=x.IDBKeyRange||IDBKeyRange,ea=x.DOMStringList||(self?Array:DOMStringList),L=null!==x.constructor.toString().match(/WorkerGlobalScope/),V=!!v.webkitGetDatabaseNames,fa=!!self.Worker,z=function(a){var b={},c;if(r(a)){b=function(){return a.apply(this,arguments)};for(c in a)a.hasOwnProperty(c)&&
(b[c]=a[c]);return b}if(M(a))return parseInt(a,10);if(y(a))return a=a.slice(0),k(a,function(c,b){a[b]=z(c)}),a;if(!D(a))return a;s(a,function(a,c){!D(c)||r(c)||y(c)?b[a]=c:b[a]=z(c)});return b},p=function(a){if(D(a)){var b=0;s(a,function(){b+=1});if(0===b)return!0}return void 0!==a&&null!==a&&""!==a&&(!y(a)||0<a.length)?!1:!0},g=function(a,b,c,d){if(r(a))return a.apply(c||{},b||[]);if(r(d))return g(d,[])},e=function(a){return p(a)?!1:!0},W=function(a,b){return b===a},X=function(a){var b={};k(w,function(c){e(a[c])&&
(b[c]=a[c])});return b},y=function(a){var b=!1;if(a instanceof Array||a instanceof ea)b=!0;return b},Y=function(a){return"boolean"===typeof a||"true"===a||"false"===a?!0:!1},r=function(a){return"function"===typeof a},D=function(a){return null!==a&&void 0!==a&&"object"===typeof a&&"[object Object]"===a.toString()},M=function(a){var b;(b="number"===typeof a)||(b=void 0===isNaN(parseInt(a,10),!1));return b?!0:!1},Z=function(a){return"string"===typeof a},aa=function(a,b){for(var c=b||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
d=a||16,f=0,e=c.length,l=[],f=0;f<d;f+=1)l.push(c[Math.floor(100*Math.random())%e]);return l.join("")},k=function(a,b,c){var d,f=a?a.length:0;c=c||1;for(d=0;d<f;d+=c)g(b,[a[d],d])},s=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])},E=function(){var a=!1,b=null,c=[],d=[],f=[],e=[],l=[],h=function(F,h,ga){var ha=E();d.push(E);!0===a&&g(b?F:h,c);k([[e,F],[l,h],[f,ga]],function(a){var c=a[1];r(c)&&a[0].push(c)});return ha.promise};h.then=h;h.error=function(a){h(null,a)};h.notify=function(a){h(null,
null,a)};return{promise:h,resolve:function(){var f=arguments;a=b=!0;c=f;k(e,function(a){g(a,f)});k(d,function(a){g(a.resolve,f)})},notify:function(){var a=arguments;k(f,function(c){g(c,a)});k(d,function(c){g(c.notify,a)})},reject:function(){var f=arguments;b=!1;a=!0;c=f;k(l,function(a){g(a,f)})}}},t=function(a,b,c){var d=!1;e(a)&&(D(a)?s(a,function(a,e){if(!0===c&&b===a||b===e)d=!0}):y(a)&&k(a,function(a,e){if(!0===c&&b===e||b===a)d=!0}));return d},N="on_success on_error on_abort on_blocked on_upgrade_needed on_close on_complete".split(" "),
ba="amount db entry entries idx indexes key last_entry last_key last_primary_key new_version objectstore old_version stores value".split(" "),w="auto_increment callback data database databases direction duplicates index index_key_path index_multi_entry index_unique key_path limit multi_entry primary_key skip store store_key_path unique version".split(" "),O="database store version store_key_path unique multi_entry data auto_increment on_complete on_error on_success on_abort key index index_key_path index_multi_entry index_unique limit skip".split(" "),
B=function(a){var b={};k(O,function(c){e(a[c])&&(b[c]=a[c])});return b},ca=function(a){var b=function(a){!1===t(w,a)&&w.push(a);!1===t(O,a)&&O.push(a)};y(a)?k(a,function(a){b(a)}):b(a)},H=function(a,b){var c={},d=function(a){var c=[];k(a,function(a){c.push(a)});return c};k(w,function(b){e(a[b])&&(c[b]="db"===b?P({name:a[b].name,version:a[b].version,objectStoreNames:d(a[b].objectStoreNames)},"database",a):"objectstore"===b?P({name:a[b].name,indexNames:d(a[b].indexNames),autoIncrement:a[b].autoIncrement,
keyPath:a[b].keyPath},"store",a):"idx"===b?P({name:a[b].name,multiEntry:a[b].multiEntry,unique:a[b].unique,keyPath:a[b].keyPath},"index",a):"indexes"===b||"stores"===b||"databases"===b?d(a[b]):a[b])});W(da(b),"versionchange")&&ia(a);return c},da=function(a){return t(["add.index","remove.index","add.store","remove.store"],a)?"versionchange":t(["get.entry","get.entries"],a)?"readonly":"readwrite"},Q=function(a,b){var c=function(c){a.event=c;return a},d,f=0,$=a.limit,l=a.skip;a.direction=a.direction||
e(a)&&!1===a.duplicates?"nextunique":"next";a.range=a.range||J.get(a);e(a.data)&&(a.data=r(a.data)?a.data():z(a.data));p(a.transaction)&&(a.db=a.event.target.result,a.transaction=a.db.transaction([a.store],a.type));p(a.objectstore)&&(a.objectstore=a.transaction.objectStore(a.store));p(a.idx)&&!p(a.index)&&(a.idx=a.objectstore.index(a.index));d=p(a.index)?a.objectstore.openCursor(a.range,a.direction):a.idx.openCursor(a.range,a.direction);a.amount=a.amount||0;d.transaction.addEventListener("complete",
function(b){a.cursor=d.result;a=c(b);a.last_key=a.key;delete a.key;a.last_primary_key=a.primary_key;delete a.primary_key;a.last_entry=a.entry;delete a.entry;delete a.direction;a.last_entry instanceof IDBOpenDBRequest&&delete a.last_entry;a.db.close();complete(a)});d.transaction.addEventListener("error",function(b){a.error=b;a=c(b);error(a)});d.addEventListener("success",function(h){a.cursor=d.result;e(a.cursor)&&(a.primary_key=a.cursor.primaryKey,a.key=a.cursor.key,a.direction=a.cursor.direction);
a=c(h);p(l)?(p($)||f++<$)&&g(b,[a]):(e(a.cursor.advance)&&a.cursor.advance(l),l=null)})},C={},ja=function(a,b,c,d,f,e){var l=aa(),h=function(c){var b=c.data;if(void 0!==C[b.uid])switch(c.data.type){case "success":delete C[b.uid];a.removeEventListener("message",h);g(d,[b.context]);break;case "error":delete C[b.uid];a.removeEventListener("message",h);g(f,[b.context]);break;case "notify":g(e,[b.context])}},F=function(a){if(!r(a))return D(a)?s(a,function(c,b){a[c]=F(b)}):y(a)&&k(a,function(c,b){a[b]=
F(c)}),a};C[l]={success:d,error:f,notify:e};a.addEventListener("message",h);a.postMessage({dash:b,context:F(c),uid:l});return l},ka=function(a,b){var c=E(),d={on_success:b.on_success,on_error:b.on_error,on_abort:b.on_abort,on_complete:b.on_complete,on_upgrade_needed:b.on_upgrade_needed,on_blocked:b.on_blocked,on_close:b.on_close},f=new Worker(U),e=function(a){s(d,function(c,b){a[c]=b});return a};s(d,function(a,c){delete b[a]});ja(f,a,b,function(a){c.resolve(e(a))},function(a){c.reject(e(a))},function(a){c.notify(e(a))});
return c.promise},m={},la=function(a){var b={database:!1,store:!1,index:!1};e(m[a.database])&&e(m[a.database].data)&&(b.database=!0,e(m[a.database].stores[a.store])&&e(m[a.database].stores[a.store].data)&&(b.store=!0,e(m[a.database].stores[a.store].indexes[a.index])&&e(m[a.database].stores[a.store].indexes[a.index].data)&&(b.index=!0)));return b},P=function(a,b,c){if(e(c)&&e(c.database)){m[c.database]=m[c.database]||{stores:{},data:null};if("database"===b)return m[c.database].data=a;if(e(c.store)){m[c.database].stores[c.store]=
m[c.database].stores[c.store]||{indexes:{},data:null};if("store"===b)return m[c.database].stores[c.store].data=a;e(c.index)&&(m[c.database].stores[c.store].indexes[c.index]=m[c.database].stores[c.store].indexes[c.index]||{data:null},"index"===b&&(m[c.database].stores[c.store].indexes[c.index].data=a))}}return a},ia=function(a){delete m[a.database];return a},ma=function(a,b,c){var d=da(c),f=function(a,c){var b=B(a);if(p(a.database))return g(c,[a]);b.on_success=function(a){a.on_success=null;a.version=
a.db.version;a.db.close();g(c,[a])};b.on_upgrade_needed=function(a){a.upgraded=!0;a.version=a.new_version;a.on_upgrade_needed=null;a.transaction.oncomplete=function(){a.db.close();g(c,[a])}};n.get(b)},k=function(a,b){var f=B(a);if(p(a.store)||t(["add.store"],c))return g(b,[a]);f.on_success=function(a){a.on_success=null;a.db=a.request.result;a.db.objectStoreNames.contains(a.store)?(null!==a.transaction&&(a.objectstore=a.transaction.objectStore([a.store],d)),a.db.close(),g(b,[a])):(a.version=a.db.version+
1,a.on_success=null,a.on_upgrade_needed=function(a){a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.db.close();g(b,[a])});a.objectstore=a.db.createObjectStore(a.store,{keyPath:Z(a.store_key_path)?a.store_key_path:null,autoIncrement:Y(a.auto_increment)?a.auto_increment:!1})},n.get(a))};f.version=null;n.get(f)},l=function(a,b){var f=B(a);if(p(a.store)||p(a.index)||t("add.store get.store remove.store get.stores remove.stores remove.index add.index".split(" "),c))return g(b,
[a]);f.on_success=function(c){c.on_success=null;c.db=c.request.result;c.objectstore=c.db.transaction([c.store],"readonly").objectStore(c.store);c.transaction=c.objectstore.transaction;c.objectstore.indexNames.contains(a.index)?(c.db.close(),g(b,[c])):(c.version=c.db.version+1,c.on_success=null,c.on_upgrade_needed=function(a){a.objectstore=a.transaction.objectStore([a.store]);a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.on_success=null;g(b,[a]);a.db.close()});a.on_success=
null;a.idx=a.objectstore.createIndex(a.index,a.index_key_path,{unique:a.index_unique||!1,multiEntry:a.index_multi_entry||!1})},c.db.close(),n.get(c))};n.get(f)},h=function(b){var f=b.on_success,h=b.on_complete,l=b.on_error,q=B(b),k=function(b){e(b.store)&&"versionchange"!==d?(null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),b.objectstore=b.transaction.objectStore(b.store),b.transaction.addEventListener("complete",function(){b.db.close()})):e(b.store)&&(b.db=b.request.result,b.transaction=
b.request.transaction,null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),t(["add.store","remove.store"],c)||(b.objectstore=b.transaction.objectStore(b.store)),b.transaction.addEventListener("complete",function(){b.db.close()}));b.on_success=function(a){a=H(a,c);a.on_success=f;success(a)};b.on_complete=function(a){a=H(a,c);a.on_complete=h;g(a.on_complete,[a])};b.on_error=function(a){a=H(a,c);a.on_error=l;error(a)};g(a,[b])};q.version=b.version;if(t(["get.databases","remove.database",
"get.database"],c))return g(a,[H(b,c)]);"versionchange"!==d?(q.on_success=k,q.on_upgrade_needed=null):(q.version=b.db.version+1,q.on_upgrade_needed=k,q.on_success=null);q.on_complete=null;n.get(q)};b=X(b);b.type=d;(function(a){if(e(a)){var b=a?a.on_upgrade_needed:void 0,d=a?a.on_success:void 0,g=la(a);if(t(["get.database","remove.database"],c)||!0===g.database&&!0===g.store&&!0===g.index)return h(a);a.on_success=null;a.on_upgrade_needed=null;!1===g.database?f(a,function(a){k(a,function(a){l(a,function(a){a.on_success=
d;a.on_upgrade_needed=b;h(a)})})}):!1===g.store?k(a,function(a){l(a,function(a){a.on_success=d;a.on_upgrade_needed=b;h(a)})}):l(a,function(a){a.on_success=d;a.on_upgrade_needed=b;h(a)})}})(b)},R=[],S=[],T={clone:z,contains:t,deferred:E,exists:e,is:W,isEmpty:p,isnt:function(a,b){return b!==a},isArray:y,isBoolan:Y,isRegEx:function(a){return r(a.constructor)&&null!==a.constructor.toString().match(/RegExp/)},isFunction:r,isObject:D,isNumber:M,isString:Z,apply:g,each:k,iterate:s,random:aa,api:I},na=function(a,
b){return function(c){c=c||{};var d={};k(N,function(a){d[a.replace(/^on_/,"")]=c[a]});!0===L&&s(c,function(a){!0===t(ba,a)?delete c[a]:ca(a)});return function(a,c,d,h){var m=E(),n=0,u=t(["get.entries","update.entries","remove.entries"],b),x={success:"s",error:"e",abort:"a",complete:"c",upgrade_needed:"u",blocked:"b",closed:"l"},q,y=m.promise;s(c,function(b){a["on_"+b]=function(a,b,c){return function(d){D(d)&&s(b,function(a,b){var c="on_"+a;r(b)?d[c]=b:delete d[c]});d=X(d);var e=null,f,h,l=0,q=E(),
n=q.promise,e="s"===a&&!0===u?"notify":"e"===a||"a"===a||"b"===a?"reject":"resolve";f=H(d,c);k(S,function(a){h=g(a,[{type:e,method:c,context:f,priority:++l,promise:n}],z(T));f=h.context||f;n=h.promise||n;t(["reject","resolve"],e)&&(e=h.type||e)});n(function(a){if(!p(a.type))m[a.type](a.context)},function(a){m.reject(a.context)},function(a){m.notify(a.context)});q.resolve(z({method:c,type:e,context:f}))}}(x[b],c,h)});if(null!==h.match(/\.behavior/))g(d,[a]);else try{var w=E(),v=w.promise,A={},B=!1,
C=null;T.api=I;k(R,function(b){B||(q=g(b,[{type:C,method:h,context:a,priority:++n,promise:v}],z(T)),a=q.context||a,s(a,function(a){ca(a)}),"resolve"===q.type?B=!0:h=q.method||h,C=q.type,v=q.promise)});v(function(b){!0!==u&&!0!==B||!0===L||!0!==V||!e(U)||!0!==fa?ma(d,a,b.method):(s({on_success:b.context.on_success,on_error:b.context.on_error,on_abort:b.context.on_abort,on_complete:b.context.on_complete,on_upgrade_needed:b.context.on_upgrade_needed,on_blocked:b.context.on_blocked,on_close:b.context.on_close},
function(b,c){A[b]=a[b];a[b]=c}),!1===B&&(v=ka(h,a)),v(function(a){a=a.context||a;g(A.on_complete,[a])},function(a){a=a.context||a;g(A.on_error,[a])},function(a){a=a.context||a;g(A.on_success,[a])}))},function(b){a.error=b.error;error(a)});w.resolve(z({method:h,type:C,context:a}))}catch(G){a.error=G,error(a)}return y}(c,d,a,b)}},oa=self,I;w.push.apply(w,N);w.push.apply(w,ba);k(N,function(a){oa[a.replace(/^on_/g,"")]=function(b){g(b[a],[b]);return b}});n.close=function(a,b){a.db.close();!0!==b&&success(a)};
n.remove=function(a,b){v.deleteDatabase(a.database);!0!==b&&success(a)};n.get=function(a){var b=a.on_upgrade_needed,c=a.on_success,d=a.on_blocked,f=!1,k=function(a,b){b.event=a;b.transaction=b.request?b.request.transaction:a.target.transaction;e(b.transaction)&&e(b.transaction.db)&&(b.db=b.transaction.db);e(a.newVersion)?(b.new_version=a.newVersion,b.old_version=a.oldVersion,b.upgrade=b.new_version!==b.old_version?!0:!1):b.upgrade=!1;return b};a.request=M(a.version)?v.open(a.database,a.version):v.open(a.database);
a.db&&r(a.db.close)&&a.db.close();a.request.addEventListener("success",function(b){f||(a=k(b,a),a.upgrade=!1,a.opened=!0,a.on_success=c,a.db=a.event.target.result,success(a))});a.request.addEventListener("upgradeneeded",function(c){f=!0;a=k(c,a);a.upgrade=!0;a.opened=!0;a.on_upgrade_needed=b;upgrade_needed(a)});a.request.addEventListener("blocked",function(b){a=k(b,a);g(d,[a])})};u=function(a){success(a)};G=function(a){a.idx=a.objectstore.index(a.index);success(a)};J.get=function(a){var b=null,c=
a.left_bound,d=a.right_bound,f=a.includes_left_bound,g=a.includes_right_bound;e(c)&&e(d)&&e(f)&&e(g)?b=A.bound(c,d,f,g):e(c)&&e(f)?b=A.lowerBound(c,f):e(d)&&e(g)?b=A.upperBound(d,g):e(a.value)&&(b=A.only(a.value));a.result=b;success(a);return b};K.add=function(a){y(a)?(r(a[0])&&R.push(a[0]),r(a[1])&&S.push(a[1])):r(a)&&(R.push(a),S.push(a))};I=function(a){var b={},c=[],d;s(a,function(a,e){c=a.split(".");d=c[0];b[d]=b[d]||{};b[d][c[1]]=na(e,a)});return b}({"add.entry":function(a){var b;a.data=r(a.data)?
a.data():z(a.data);b=a.objectstore.add(a.data);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.key=b.result;a.entry=a.data;p(a.objectstore.keyPath)||(a.entry[a.objectstore.keyPath]=a.key);success(a)})},"add.behavior":K.add,"add.database":n.get,"add.store":u,"add.index":G,"clear.store":function(a){a.objectstore.clear();success(a)},"count.entries":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),b=
p(a.key)?a.idx.count():a.idx.count(a.key)):b=p(a.key)?a.objectstore.count():a.objectstore.count(a.key);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.total=b.result;success(a)})},"get.behaviors":K.get,"get.database":n.get,"get.databases":function(a){var b=a.on_success;if(!1===V)return error(a);a.request=v.webkitGetDatabaseNames();a.request.addEventListener("success",function(c){a.databases=c.target.result;a.on_success=
b;success(a)})},"get.store":u,"get.stores":function(a){a.stores=a.db.objectStoreNames;success(a)},"get.index":G,"get.indexes":function(a){a.indexes=a.objectstore.indexNames;success(a)},"get.entries":function(a){a.type="readonly";var b=a.on_success;a.on_success=null;Q(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"get.entry":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),
b=!1===a.value?a.idx.getKey(a.key):a.idx.get(a.key)):b=a.objectstore.get(a.key);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.entry=b.result;p(a.entry)?(a.error="no such entry",error(a)):success(a)})},"remove.database":n.remove,"remove.entries":function(a){a.type="readwrite";var b=a.on_success;Q(a,function(a){a.entry=a.request;if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=
1,a.cursor["delete"](),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"remove.index":function(a){a.objectstore.deleteIndex(a.index);success(a)},"remove.entry":function(a){var b,c=e(a.range)||e(a.upper)||e(a.lower)||e(a.only);b=a.objectstore["delete"](c?a.range||J.get(a):a.key);a.transaction.addEventListener("complete",function(){a.entry=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)})},"remove.store":function(a){a.db.deleteObjectStore(a.store);
success(a)},"update.entries":function(a){a.type="readwrite";var b=a.on_success;Q(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor.update(a.data),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"update.entry":function(a){var b;a.data=r(a.data)?a.data():z(a.data);b=e(a.key)?a.objectstore.put(a.data,a.key):a.objectstore.put(a.data);b.addEventListener("success",function(){a.key=b.result;a.entry=a.data;success(a)});a.transaction.addEventListener("error",
function(b){a.error=b.target.error.message;error(a)})}});!0===L&&x.addEventListener("message",function(a){var b=a.data,c=b.dash.split(".");a=c[0];var c=c[1],d=function(a){b.context=a;x.postMessage(b)};void 0!==dash[a]&&void 0!==dash[a][c]?I[a][c](b.context)(function(a){b.type="success";d(a)},function(a){b.type="error";d(a)},function(a){b.type="notify";d(a)}):(b.type="error",d({error:"No such method"}))},!1);return I}(self||{});
