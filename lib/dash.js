var dash=function(r){var b={dbs:{},database:{},databases:{},store:{},stores:{},index:{},indexes:{},range:{},entry:{},entries:{},behavior:{},attribute:{},transaction:{},db:r.indexedDB||indexedDB,kr:r.IDBKeyRange||IDBKeyRange,sl:r.DOMStringList||(self?Array:DOMStringList)},s=function(a){var b={};if(x(a))return parseInt(a,10);if(t(a))return a.slice(0);u(a,function(a,e){!B(e)||m(e)||t(e)?b[a]=e:b[a]=b(e)});return b},k=function(a){return void 0!==a&&null!==a&&""!==a&&(!t(a)||0<a.length)?!1:!0},g=function(a,
c,d,e){if(m(a))return a.apply(d||b,c||[]);if(m(e))return g(e,[])},f=function(a){return k(a)?!1:!0},C=function(a,b,d){a=a||{};u(s(b),function(b,c){!0===d&&B(c)?a[b]=C({},c,d):a[b]=c});return a},G=function(a){var c={};l(b.attribs,function(b){f(a[b])&&(c[b]=a[b])});return c},t=function(a){var c=!1;if(a instanceof Array||a instanceof b.sl)c=!0;return c},y=function(a){return"boolean"===typeof a||"true"===a||"false"===a?!0:!1},m=function(a){return"function"===typeof a},B=function(a){return null!==a&&"object"===
typeof a&&"[object Object]"===a.toString()},x=function(a){var b;(b="number"===typeof a)||(b=void 0===isNaN(parseInt(a,10),!1));return b?!0:!1},D=function(a){return"string"===typeof a},l=function(a,b,d){var e,h=a.length;d=d||1;for(e=0;e<h;e+=d)g(b,[a[e],e])},u=function(a,b){for(var d in a)a.hasOwnProperty(d)&&b(d,a[d])},w=function(){var a=!1,b=null,d=[],e=[],h=[],f=[],q=[];return{promise:function(z,v,H){var I=w();e.push(w);!0===a?g(b?z:v,d):l([[f,z],[q,v],[h,H]],function(a){var b=a[1];m(b)&&a[0].push(b)});
return I.promise},resolve:function(){var h=arguments;!1===a&&(a=b=!0,d=h,l(f,function(a){g(a,h)}),l(e,function(a){g(a.resolve,h)}))},notify:function(){var a=arguments;l(h,function(b){g(b,a)});l(e,function(b){g(b.notify,a)})},reject:function(){var e=arguments;!1===a&&(b=!1,a=!0,d=e,l(q,function(a){g(a,e)}))}}},p=function(a,b,d){var e=!1;f(a)&&u(a,function(a,f){if(!0===d&&b===a||b===f)e=!0});return e},A;b.standardCallbackNames="on_success on_error on_abort on_blocked on_upgrade_needed on_close on_complete".split(" ");
b.attribs="amount auto_increment callback data database databases db direction duplicates entries entry idx index index_key_path index_multi_entry index_unique indexes key key_path last_entry last_key last_primary_key limit match map multi_entry new_version objectstore old_version primary_key skip store store_key_path stores total throttle type unique value version".split(" ");b.attribs.push.apply(b.attribs,b.standardCallbackNames);b.results=function(a){var c={},d=function(a){var b=[];l(a,function(a){b.push(a)});
return b};l(b.attribs,function(b){f(a[b])&&(c[b]="db"===b?{name:a[b].name,version:a[b].version,objectStoreNames:d(a[b].objectStoreNames)}:"objectstore"===b?{name:a[b].name,indexNames:d(a[b].indexNames),autoIncrement:a[b].autoIncrement,keyPath:a[b].keyPath}:"idx"===b?{name:a[b].name,multiEntry:a[b].multiEntry,unique:a[b].unique,keyPath:a[b].keyPath}:"indexes"===b||"stores"===b||"databases"===b?d(a[b]):a[b])});return c};l(b.standardCallbackNames,function(a){b[a.replace(/^on_/g,"")]=function(b){g(b[a],
[b]);return b}});b.standardCursor=function(a,c){var d=function(b){a.event=b;return a},e,h=0,n=a.limit,q=a.skip;a.direction=a.direction||f(a)&&!1===a.duplicates?"nextunique":"next";a.range=a.range||b.range.get(a);f(a.data)&&(a.data=m(a.data)?a.data():s(a.data));k(a.transaction)&&(a.db=a.event.target.result,a.transaction=a.db.transaction([a.store],a.type));k(a.objectstore)&&(a.objectstore=a.transaction.objectStore(a.store));k(a.idx)&&!k(a.index)&&(a.idx=a.objectstore.index(a.index));e=k(a.index)?a.objectstore.openCursor(a.range,
a.direction):a.idx.openCursor(a.range,a.direction);a.amount=a.amount||0;e.transaction.addEventListener("complete",function(c){a.cursor=e.result;a=d(c);a.last_key=a.key;delete a.key;a.last_primary_key=a.primary_key;delete a.primary_key;a.last_entry=a.entry;delete a.entry;delete a.direction;a.db.close();b.complete(a)});e.transaction.addEventListener("error",function(c){a.error=c;a=d(c);b.error(a)});e.addEventListener("success",function(b){a.cursor=e.result;f(a.cursor)&&(a.primary_key=a.cursor.primaryKey,
a.key=a.cursor.key,a.direction=a.cursor.direction);a=d(b);k(q)?(k(n)||h++<n)&&g(c,[a]):(f(a.cursor.advance)&&a.cursor.advance(q),q=null)})};b.database.close=function(a,c){a.db.close();!0!==c&&b.success(a)};b.database.remove=function(a,c){b.db.deleteDatabase(a.database);!0!==c&&b.success(a)};b.database.get=function(a){var c=a.on_upgrade_needed,d=a.on_success,e=a.on_blocked,h=!1,n=function(a,b){b.event=a;b.transaction=b.request?b.request.transaction:a.target.transaction;f(b.transaction)&&f(b.transaction.db)&&
(b.db=b.transaction.db);f(a.newVersion)?(b.new_version=a.newVersion,b.old_version=a.oldVersion,b.upgrade=b.new_version!==b.old_version?!0:!1):b.upgrade=!1;return b};a.request=x(a.version)?b.db.open(a.database,a.version):b.db.open(a.database);a.db&&a.db.close();a.request.addEventListener("success",function(c){h||(a=n(c,a),a.upgrade=!1,a.opened=!0,a.on_success=d,a.db=a.event.target.result,b.success(a))});a.request.addEventListener("upgradeneeded",function(d){h=!0;a=n(d,a);a.upgrade=!0;a.opened=!0;a.on_upgrade_needed=
c;b.upgrade_needed(a)});a.request.addEventListener("blocked",function(b){a=n(b,a);g(e,[a])})};b.databases.get=function(a){var c=a.on_success;if(!m(b.db.webkitGetDatabaseNames))return b.error(a);a.request=b.db.webkitGetDatabaseNames();a.request.addEventListener("success",function(d){a.databases=d.target.result;a.on_success=c;b.success(a)})};b.store.clear=function(a){a.objectstore.clear();b.success(a)};b.store.remove=function(a){a.db.deleteObjectStore(a.store);b.success(a)};b.store.get=function(a){b.success(a)};
b.stores.get=function(a){a.stores=a.db.objectStoreNames;b.success(a)};b.index.get=function(a){a.idx=a.objectstore.index(a.index);b.success(a)};b.index.remove=function(a){a.objectstore.deleteIndex(a.index);b.success(a)};b.indexes.get=function(a){a.indexes=a.objectstore.indexNames;b.success(a)};b.entry.add=function(a){var c;a.data=m(a.data)?a.data():s(a.data);c=a.objectstore.add(a.data);a.transaction.addEventListener("error",function(d){a.error=d.target.error.message;b.error(a)});c.addEventListener("success",
function(){a.key=c.result;b.success(a)})};b.entry.remove=function(a){var c,d=f(a.range)||f(a.upper)||f(a.lower)||f(a.only);c=a.objectstore["delete"](d?a.range||b.range.get(a):a.key);a.transaction.addEventListener("complete",function(){a.entry=c.result;b.success(a)});a.transaction.addEventListener("error",function(d){a.error=d.target.error.message;b.error(a)})};b.entry.get=function(a){var c;f(a.index)?(a.idx=a.objectstore.index(a.index),c=!1===a.value?a.idx.getKey(a.key):a.idx.get(a.key)):c=a.objectstore.get(a.key);
a.transaction.addEventListener("error",function(d){a.error=d.target.error.message;b.error(a)});c.addEventListener("success",function(){a.entry=c.result;b.success(a)})};b.entry.put=function(a){var c;a.data=m(a.data)?a.data():s(a.data);c=f(a.key)?a.objectstore.put(a.data,a.key):a.objectstore.put(a.data);a.transaction.addEventListener("complete",function(){a.key=c.result;b.success(a)});a.transaction.addEventListener("error",function(d){a.error=d.target.error.message;b.error(a)})};b.entries.remove=function(a){a.type=
"readwrite";var c=a.on_success;b.standardCursor(a,function(a){a.entry=a.request;if(f(a.cursor)&&(a.on_success=c,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor["delete"](),b.success(a),f(a.cursor["continue"])))a.cursor["continue"]()})};b.entries.get=function(a){a.type="readonly";var c=a.on_success;a.on_success=null;b.standardCursor(a,function(a){if(f(a.cursor)&&(a.on_success=c,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,b.success(a),f(a.cursor["continue"])))a.cursor["continue"]()})};
b.entries.count=function(a){var c;f(a.index)?(a.idx=a.objectstore.index(a.index),c=k(a.key)?a.idx.count():a.idx.count(a.key)):c=k(a.key)?a.objectstore.count():a.objectstore.count(a.key);a.transaction.addEventListener("error",function(c){a.error=c.target.error.message;b.error(a)});c.addEventListener("success",function(){a.total=c.result;b.success(a)})};b.entries.update=function(a){a.type="readwrite";var c=a.on_success;b.standardCursor(a,function(a){if(f(a.cursor)&&(a.on_success=c,a.entry=a.cursor.value,
a.amount=a.amount||0,a.amount+=1,a.cursor.update(a.data),b.success(a),f(a.cursor["continue"])))a.cursor["continue"]()})};b.range.get=function(a){var c=null,d=a.left_bound,e=a.right_bound,h=a.includes_left_bound,g=a.includes_right_bound;f(d)&&f(e)&&f(h)&&f(g)?c=b.kr.bound(d,e,h,g):f(d)&&f(h)?c=b.kr.lowerBound(d,h):f(e)&&f(g)?c=b.kr.upperBound(e,g):f(a.value)&&(c=b.kr.only(a.value));a.result=c;b.success(a);return c};b.transaction.type=function(a){return p(["add.index","remove.index","add.store","remove.store"],
a)?"versionchange":p(["get.entry","get.entries"],a)?"readonly":"readwrite"};b.detached="database store version store_key_path unique multi_entry data auto_increment on_complete on_error on_success on_abort key index index_key_path index_multi_entry index_unique limit skip".split(" ");b.detachContext=function(a){var c={};l(b.detached,function(b){f(a[b])&&(c[b]=a[b])});return c};b.stage=function(a,c,d){var e=b.transaction.type(d),h=function(a,c){var d=b.detachContext(a);if(k(a.database))return g(c,
[a]);d.on_success=function(a){a.on_success=null;a.version=a.db.version;a.db.close();g(c,[a])};d.on_upgrade_needed=function(a){a.upgraded=!0;a.version=a.new_version;a.on_upgrade_needed=null;a.transaction.oncomplete=function(){a.db.close();g(c,[a])}};b.database.get(d)},l=function(a,c){var h=b.detachContext(a);if(k(a.store)||p(["add.store"],d))return g(c,[a]);h.on_success=function(a){a.on_success=null;a.db=a.request.result;a.db.objectStoreNames.contains(a.store)?(null!==a.transaction&&(a.objectstore=
a.transaction.objectStore([a.store],e)),a.db.close(),g(c,[a])):(a.version=a.db.version+1,a.on_success=null,a.on_upgrade_needed=function(a){a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.db.close();g(c,[a])});a.objectstore=a.db.createObjectStore(a.store,{keyPath:D(a.store_key_path)?a.store_key_path:null,autoIncrement:y(a.auto_increment)?a.auto_increment:!1})},b.database.get(a))};h.version=null;b.database.get(h)},m=function(a,c){var e=b.detachContext(a);if(k(a.store)||
k(a.index)||p("add.store get.store remove.store get.stores remove.stores remove.index add.index".split(" "),d))return g(c,[a]);e.on_success=function(d){d.on_success=null;d.db=d.request.result;d.objectstore=d.db.transaction([d.store],"readonly").objectStore(d.store);d.transaction=d.objectstore.transaction;d.objectstore.indexNames.contains(a.index)?(d.db.close(),g(c,[d])):(d.version=d.db.version+1,d.on_success=null,d.on_upgrade_needed=function(a){a.objectstore=a.transaction.objectStore([a.store]);a.on_upgrade_needed=
null;a.transaction.addEventListener("complete",function(){a.on_success=null;g(c,[a]);a.db.close()});a.on_success=null;a.idx=a.objectstore.createIndex(a.index,a.index_key_path,{unique:a.index_unique||!1,multiEntry:a.index_multi_entry||!1})},d.db.close(),b.database.get(d))};b.database.get(e)},z=function(c){var h=c.on_success,l=c.on_complete,m=c.on_error,k=b.detachContext(c),n=function(c){f(c.store)&&"versionchange"!==e?(null===c.transaction&&(c.transaction=c.db.transaction([c.store],e)),c.objectstore=
c.transaction.objectStore(c.store),c.transaction.addEventListener("complete",function(){c.db.close()})):f(c.store)&&(c.db=c.request.result,c.transaction=c.request.transaction,null===c.transaction&&(c.transaction=c.db.transaction([c.store],e)),p(["add.store","remove.store"],d)||(c.objectstore=c.transaction.objectStore(c.store)),c.transaction.addEventListener("complete",function(){c.db.close()}));c.on_success=function(a){a=b.results(a);a.on_success=h;b.success(a)};c.on_complete=function(a){a=b.results(a);
a.on_complete=l;g(a.on_complete,[a])};c.on_error=function(a){a=b.results(a);a.on_error=m;b.error(a)};g(a,[c])};k.version=c.version;if(p(["get.databases","remove.database","get.database"],d))return g(a,[b.results(c)]);"versionchange"!==e?(k.on_success=n,k.on_upgrade_needed=null):(k.version=c.db.version+1,k.on_upgrade_needed=n,k.on_success=null);k.on_complete=null;b.database.get(k)};c=G(c);c.type=e;(function(a){if(f(a)){var b=a?a.on_upgrade_needed:void 0,c=a?a.on_success:void 0;if(p(["get.database",
"remove.database"],d))return z(a);a.on_success=null;a.on_upgrade_needed=null;h(a,function(a){l(a,function(a){m(a,function(a){a.on_success=c;a.on_upgrade_needed=b;z(a)})})})}})(c)};b.attribute.add=function(a){var c=function(a){!1===p(b.attribs,a)&&b.attribs.push(a);!1===p(b.detached,a)&&b.detached.push(a)};t(a)?l(a,function(a){c(a)}):c(a)};b.behavior.filters=[];b.behavior.actions=[];b.behavior.context={clone:s,contains:p,deferred:w,exists:f,extend:C,is:function(a,b){return b===a},isEmpty:k,isnt:function(a,
b){return b!==a},isArray:t,isBoolan:y,isRegEx:function(a){return m(a.constructor)&&null!==a.constructor.toString().match(/RegExp/)},isFunction:m,isObject:B,isNumber:x,isString:D,apply:g,each:l,iterate:u,api:A};b.behavior.add=function(a){t(a)?(m(a[0])&&b.behavior.filters.push(a[0]),m(a[1])&&b.behavior.actions.push(a[1])):m(a)&&(b.behavior.filters.push(a),b.behavior.actions.push(a))};b.wrap=function(a,c){return function(d){d=d||{};var e={};l(b.standardCallbackNames,function(a){e[a.replace(/^on_/,"")]=
d[a]});return function(a,d,e,f){var v=w(),r=0,t=p(["get.entries","update.entries","remove.entries"],c),s={success:"s",error:"e",abort:"a",complete:"c",upgrade_needed:"u",blocked:"b",closed:"l"},E,x=v.promise;u(d,function(c){a["on_"+c]=function(a,c,d){return function(e){B(e)&&u(c,function(a,b){var c="on_"+a;m(b)?e[c]=b:delete e[c]});e=G(e);var f,h,n,r=0,s=w(),q=s.promise;f="s"===a&&!0===t?"notify":"e"===a||"a"===a||"b"===a?"reject":"resolve";h=b.results(e);l(b.behavior.actions,function(a){n=g(a,[{type:f,
method:d,context:h,priority:++r,promise:q}],C({},b.behavior.context));h=n.context;q=n.promise||q;p(["reject","resolve"],f)&&(f=n.type)});q(function(a){k(a.type)||g(v[a.type],[a.context],v)},function(a){g(v.error,[a.context],v)});s.resolve({method:d,type:f,context:h})}}(s[c],d,f)});if(null!==f.match(/\.behavior/))g(e,[a]);else try{var y=w(),F=y.promise;b.behavior.context.api=A;l(b.behavior.filters,function(c){E=g(c,[{type:null,method:f,context:a,priority:++r,promise:F}],C({},b.behavior.context));a=
E.context;u(a,function(a){b.attribute.add(a)});f=E.type;F=E.promise||F});F(function(a){b.stage(e,a.context,a.method)},function(c){a.error=c.error;b.error(a)});y.resolve({method:f,type:null,context:a})}catch(D){a.error=D,b.error(a)}return x}(d,e,a,c)}};A=function(a){var c={},d=[],e;u(a,function(a,f){d=a.split(".");e=d[0];c[e]=c[e]||{};c[e][d[1]]=b.wrap(f,a)});return c}({"add.entry":b.entry.add,"add.behavior":b.behavior.add,"add.attribute":b.attribute.add,"count.entries":b.entries.count,"get.database":b.database.get,
"get.databases":b.databases.get,"get.store":b.store.get,"get.stores":b.stores.get,"get.index":b.index.get,"get.indexes":b.indexes.get,"get.entry":b.entry.get,"get.entries":b.entries.get,"get.behaviors":b.behavior.get,"update.entries":b.entries.update,"put.entry":b.entry.put,"clear.store":b.store.clear,"remove.database":b.database.remove,"remove.store":b.store.remove,"remove.index":b.index.remove,"remove.entry":b.entry.remove,"remove.entries":b.entries.remove});null!==r.constructor.toString().match(/WorkerGlobalScope/)&&
r.addEventListener("message",function(a){var b=a.data,d=b.dash.split(".");a=d[0];var d=d[1],e=function(a){b.context=a;r.postMessage(b)};void 0!==dash[a]&&void 0!==dash[a][d]?A[a][d](b.context)(function(a){b.type="success";e(a)},function(a){b.type="error";e(a)},function(a){b.type="notify";e(a)}):(b.type="error",e({error:"No such method"}))},!1);return A}(self||{});