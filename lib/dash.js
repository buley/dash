var dash=function(u){var w=u.document?u.document.getElementsByTagName("script"):[],R=(w=w[w.length-1]||null)?w.src:null,n={},H={},w={},z=u.indexedDB||indexedDB,x=u.IDBKeyRange||IDBKeyRange,Y=u.DOMStringList||(self?Array:DOMStringList),I=null!==u.constructor.toString().match(/WorkerGlobalScope/),S=!!z.webkitGetDatabaseNames,Z=!!self.Worker,y=function(a){var b={};if(J(a))return parseInt(a,10);if(A(a))return a.slice(0);v(a,function(a,d){!K(d)||q(d)||A(d)?b[a]=d:b[a]=y(d)});return b},m=function(a){return void 0!==
a&&null!==a&&""!==a&&(!A(a)||0<a.length)?!1:!0},f=function(a,b,c,d){if(q(a))return a.apply(c||{},b||[]);if(q(d))return f(d,[])},e=function(a){return m(a)?!1:!0},T=function(a){var b={};p(r,function(c){e(a[c])&&(b[c]=a[c])});return b},A=function(a){var b=!1;if(a instanceof Array||a instanceof Y)b=!0;return b},U=function(a){return"boolean"===typeof a||"true"===a||"false"===a?!0:!1},q=function(a){return"function"===typeof a},K=function(a){return null!==a&&"object"===typeof a&&"[object Object]"===a.toString()},
J=function(a){var b;(b="number"===typeof a)||(b=void 0===isNaN(parseInt(a,10),!1));return b?!0:!1},V=function(a){return"string"===typeof a},p=function(a,b,c){var d,g=a.length;c=c||1;for(d=0;d<g;d+=c)f(b,[a[d],d])},v=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])},B=function(){var a=!1,b=null,c=[],d=[],g=[],e=[],k=[];return{promise:function(h,t,$){var aa=B();d.push(B);!0===a?f(b?h:t,c):p([[e,h],[k,t],[g,$]],function(a){var c=a[1];q(c)&&a[0].push(c)});return aa.promise},resolve:function(){var g=
arguments;!1===a&&(a=b=!0,c=g,p(e,function(a){f(a,g)}),p(d,function(a){f(a.resolve,g)}))},notify:function(){var a=arguments;p(g,function(c){f(c,a)});p(d,function(c){f(c.notify,a)})},reject:function(){var d=arguments;!1===a&&(b=!1,a=!0,c=d,p(k,function(a){f(a,d)}))}}},s=function(a,b,c){var d=!1;e(a)&&v(a,function(a,e){if(!0===c&&b===a||b===e)d=!0});return d},L="on_success on_error on_abort on_blocked on_upgrade_needed on_close on_complete".split(" "),W="amount db entry entries idx indexes key last_entry last_key last_primary_key new_version objectstore old_version stores value".split(" "),
r="auto_increment callback data database databases direction duplicates index index_key_path index_multi_entry index_unique key_path limit multi_entry primary_key skip store store_key_path unique version".split(" "),M="database store version store_key_path unique multi_entry data auto_increment on_complete on_error on_success on_abort key index index_key_path index_multi_entry index_unique limit skip".split(" "),C=function(a){var b={};p(M,function(c){e(a[c])&&(b[c]=a[c])});return b},X=function(a){var b=
function(a){!1===s(r,a)&&r.push(a);!1===s(M,a)&&M.push(a)};A(a)?p(a,function(a){b(a)}):b(a)},E=function(a){var b={},c=function(a){var c=[];p(a,function(a){c.push(a)});return c};p(r,function(d){e(a[d])&&(b[d]="db"===d?{name:a[d].name,version:a[d].version,objectStoreNames:c(a[d].objectStoreNames)}:"objectstore"===d?{name:a[d].name,indexNames:c(a[d].indexNames),autoIncrement:a[d].autoIncrement,keyPath:a[d].keyPath}:"idx"===d?{name:a[d].name,multiEntry:a[d].multiEntry,unique:a[d].unique,keyPath:a[d].keyPath}:
"indexes"===d||"stores"===d||"databases"===d?c(a[d]):a[d])});return b},ba=function(a){return s(["add.index","remove.index","add.store","remove.store"],a)?"versionchange":s(["get.entry","get.entries"],a)?"readonly":"readwrite"},N=function(a,b){var c=function(c){a.event=c;return a},d,g=0,l=a.limit,k=a.skip;a.direction=a.direction||e(a)&&!1===a.duplicates?"nextunique":"next";a.range=a.range||H.get(a);e(a.data)&&(a.data=q(a.data)?a.data():y(a.data));m(a.transaction)&&(a.db=a.event.target.result,a.transaction=
a.db.transaction([a.store],a.type));m(a.objectstore)&&(a.objectstore=a.transaction.objectStore(a.store));m(a.idx)&&!m(a.index)&&(a.idx=a.objectstore.index(a.index));d=m(a.index)?a.objectstore.openCursor(a.range,a.direction):a.idx.openCursor(a.range,a.direction);a.amount=a.amount||0;d.transaction.addEventListener("complete",function(b){a.cursor=d.result;a=c(b);a.last_key=a.key;delete a.key;a.last_primary_key=a.primary_key;delete a.primary_key;a.last_entry=a.entry;delete a.entry;delete a.direction;
a.last_entry instanceof IDBOpenDBRequest&&delete a.last_entry;a.db.close();complete(a)});d.transaction.addEventListener("error",function(b){a.error=b;a=c(b);error(a)});d.addEventListener("success",function(h){a.cursor=d.result;e(a.cursor)&&(a.primary_key=a.cursor.primaryKey,a.key=a.cursor.key,a.direction=a.cursor.direction);a=c(h);m(k)?(m(l)||g++<l)&&f(b,[a]):(e(a.cursor.advance)&&a.cursor.advance(k),k=null)})},G={},ca=function(a,b,c,d,g,e){for(var k=0,h=[],t=function(c){var b=c.data;if(void 0!==
G[b.uid])switch(c.data.type){case "success":delete G[b.uid];a.removeEventListener("message",t);f(d,[b.context]);break;case "error":delete G[b.uid];a.removeEventListener("message",t);f(g,[b.context]);break;case "notify":f(e,[b.context])}},k=0;16>k;k+=1)h.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(100*Math.random())%62]);k=h.join("");G[k]={success:d,error:g,notify:e};a.addEventListener("message",t);a.postMessage({dash:b,context:c,uid:k});return k},da=function(a,
b){var c=B(),d={on_success:b.on_success,on_error:b.on_error,on_abort:b.on_abort,on_complete:b.on_complete,on_upgrade_needed:b.on_upgrade_needed,on_blocked:b.on_blocked,on_close:b.on_close},g=new Worker(R),e=function(a){v(d,function(c,b){a[c]=b});return a};v(d,function(a,c){delete b[a]});ca(g,a,b,function(a){c.resolve(e(a))},function(a){c.reject(e(a))},function(a){c.notify(e(a))});return c.promise},ea=function(a,b,c){var d=ba(c),g=function(a,c){var b=C(a);if(m(a.database))return f(c,[a]);b.on_success=
function(a){a.on_success=null;a.version=a.db.version;a.db.close();f(c,[a])};b.on_upgrade_needed=function(a){a.upgraded=!0;a.version=a.new_version;a.on_upgrade_needed=null;a.transaction.oncomplete=function(){a.db.close();f(c,[a])}};n.get(b)},l=function(a,b){var g=C(a);if(m(a.store)||s(["add.store"],c))return f(b,[a]);g.on_success=function(a){a.on_success=null;a.db=a.request.result;a.db.objectStoreNames.contains(a.store)?(null!==a.transaction&&(a.objectstore=a.transaction.objectStore([a.store],d)),
a.db.close(),f(b,[a])):(a.version=a.db.version+1,a.on_success=null,a.on_upgrade_needed=function(a){a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.db.close();f(b,[a])});a.objectstore=a.db.createObjectStore(a.store,{keyPath:V(a.store_key_path)?a.store_key_path:null,autoIncrement:U(a.auto_increment)?a.auto_increment:!1})},n.get(a))};g.version=null;n.get(g)},k=function(a,b){var d=C(a);if(m(a.store)||m(a.index)||s("add.store get.store remove.store get.stores remove.stores remove.index add.index".split(" "),
c))return f(b,[a]);d.on_success=function(c){c.on_success=null;c.db=c.request.result;c.objectstore=c.db.transaction([c.store],"readonly").objectStore(c.store);c.transaction=c.objectstore.transaction;c.objectstore.indexNames.contains(a.index)?(c.db.close(),f(b,[c])):(c.version=c.db.version+1,c.on_success=null,c.on_upgrade_needed=function(a){a.objectstore=a.transaction.objectStore([a.store]);a.on_upgrade_needed=null;a.transaction.addEventListener("complete",function(){a.on_success=null;f(b,[a]);a.db.close()});
a.on_success=null;a.idx=a.objectstore.createIndex(a.index,a.index_key_path,{unique:a.index_unique||!1,multiEntry:a.index_multi_entry||!1})},c.db.close(),n.get(c))};n.get(d)},h=function(b){var g=b.on_success,h=b.on_complete,k=b.on_error,l=C(b),m=function(b){e(b.store)&&"versionchange"!==d?(null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),b.objectstore=b.transaction.objectStore(b.store),b.transaction.addEventListener("complete",function(){b.db.close()})):e(b.store)&&(b.db=b.request.result,
b.transaction=b.request.transaction,null===b.transaction&&(b.transaction=b.db.transaction([b.store],d)),s(["add.store","remove.store"],c)||(b.objectstore=b.transaction.objectStore(b.store)),b.transaction.addEventListener("complete",function(){b.db.close()}));b.on_success=function(a){a=E(a);a.on_success=g;success(a)};b.on_complete=function(a){a=E(a);a.on_complete=h;f(a.on_complete,[a])};b.on_error=function(a){a=E(a);a.on_error=k;error(a)};f(a,[b])};l.version=b.version;if(s(["get.databases","remove.database",
"get.database"],c))return f(a,[E(b)]);"versionchange"!==d?(l.on_success=m,l.on_upgrade_needed=null):(l.version=b.db.version+1,l.on_upgrade_needed=m,l.on_success=null);l.on_complete=null;n.get(l)};b=T(b);b.type=d;(function(a){if(e(a)){var b=a?a.on_upgrade_needed:void 0,d=a?a.on_success:void 0;if(s(["get.database","remove.database"],c))return h(a);a.on_success=null;a.on_upgrade_needed=null;g(a,function(a){l(a,function(a){k(a,function(a){a.on_success=d;a.on_upgrade_needed=b;h(a)})})})}})(b)},O=[],P=
[],Q={clone:y,contains:s,deferred:B,exists:e,is:function(a,b){return b===a},isEmpty:m,isnt:function(a,b){return b!==a},isArray:A,isBoolan:U,isRegEx:function(a){return q(a.constructor)&&null!==a.constructor.toString().match(/RegExp/)},isFunction:q,isObject:K,isNumber:J,isString:V,apply:f,each:p,iterate:v,api:F},fa=function(a,b){return function(c){c=c||{};var d={};p(L,function(a){d[a.replace(/^on_/,"")]=c[a]});!0===I&&v(c,function(a){!0===s(W,a)?delete c[a]:X(a)});return function(a,c,d,h){var t=B(),
n=0,u=s(["get.entries","update.entries","remove.entries"],b),w={success:"s",error:"e",abort:"a",complete:"c",upgrade_needed:"u",blocked:"b",closed:"l"},r,A=t.promise;v(c,function(b){a["on_"+b]=function(a,b,c){return function(d){K(d)&&v(b,function(a,b){var c="on_"+a;q(b)?d[c]=b:delete d[c]});d=T(d);var e,g,h,k=0,l=B(),n=l.promise;e="s"===a&&!0===u?"notify":"e"===a||"a"===a||"b"===a?"reject":"resolve";g=E(d);p(P,function(a){h=f(a,[{type:e,method:c,context:g,priority:++k,promise:n}],y(Q));g=h.context;
n=h.promise||n;s(["reject","resolve"],e)&&(e=h.type)});n(function(a){m(a.type)||f(t[a.type],[a.context],t)},function(a){f(t.error,[a.context],t)});l.resolve(y({method:c,type:e,context:g}))}}(w[b],c,h)});if(null!==h.match(/\.behavior/))f(d,[a]);else try{var z=B(),D=z.promise,x={};Q.api=F;p(O,function(b){r=f(b,[{type:null,method:h,context:a,priority:++n,promise:D}],y(Q));a=r.context||a;v(a,function(a){X(a)});h=r.type||h;D=r.promise||D});D(function(b){!0===u&&!0!==I&&!0===S&&e(R)&&!0===Z?(v({on_success:b.context.on_success,
on_error:b.context.on_error,on_abort:b.context.on_abort,on_complete:b.context.on_complete,on_upgrade_needed:b.context.on_upgrade_needed,on_blocked:b.context.on_blocked,on_close:b.context.on_close},function(b,c){x[b]=a[b];a[b]=c}),D=da(h,a),D(function(a){f(x.on_complete,[a])},function(a){f(x.on_error,[a])},function(a){f(x.on_success,[a])})):ea(d,a,b.method)},function(b){a.error=b.error;error(a)});z.resolve(y({method:h,type:null,context:a}))}catch(C){a.error=C,error(a)}return A}(c,d,a,b)}},ga=self,
F;r.push.apply(r,L);r.push.apply(r,W);p(L,function(a){ga[a.replace(/^on_/g,"")]=function(b){f(b[a],[b]);return b}});n.close=function(a,b){a.db.close();!0!==b&&success(a)};n.remove=function(a,b){z.deleteDatabase(a.database);!0!==b&&success(a)};n.get=function(a){var b=a.on_upgrade_needed,c=a.on_success,d=a.on_blocked,g=!1,l=function(a,b){b.event=a;b.transaction=b.request?b.request.transaction:a.target.transaction;e(b.transaction)&&e(b.transaction.db)&&(b.db=b.transaction.db);e(a.newVersion)?(b.new_version=
a.newVersion,b.old_version=a.oldVersion,b.upgrade=b.new_version!==b.old_version?!0:!1):b.upgrade=!1;return b};a.request=J(a.version)?z.open(a.database,a.version):z.open(a.database);a.db&&a.db.close();a.request.addEventListener("success",function(b){g||(a=l(b,a),a.upgrade=!1,a.opened=!0,a.on_success=c,a.db=a.event.target.result,success(a))});a.request.addEventListener("upgradeneeded",function(c){g=!0;a=l(c,a);a.upgrade=!0;a.opened=!0;a.on_upgrade_needed=b;upgrade_needed(a)});a.request.addEventListener("blocked",
function(b){a=l(b,a);f(d,[a])})};H.get=function(a){var b=null,c=a.left_bound,d=a.right_bound,g=a.includes_left_bound,f=a.includes_right_bound;e(c)&&e(d)&&e(g)&&e(f)?b=x.bound(c,d,g,f):e(c)&&e(g)?b=x.lowerBound(c,g):e(d)&&e(f)?b=x.upperBound(d,f):e(a.value)&&(b=x.only(a.value));a.result=b;success(a);return b};w.add=function(a){A(a)?(q(a[0])&&O.push(a[0]),q(a[1])&&P.push(a[1])):q(a)&&(O.push(a),P.push(a))};F=function(a){var b={},c=[],d;v(a,function(a,e){c=a.split(".");d=c[0];b[d]=b[d]||{};b[d][c[1]]=
fa(e,a)});return b}({"add.entry":function(a){var b;a.data=q(a.data)?a.data():y(a.data);b=a.objectstore.add(a.data);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.key=b.result;success(a)})},"add.behavior":w.add,"count.entries":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),b=m(a.key)?a.idx.count():a.idx.count(a.key)):b=m(a.key)?a.objectstore.count():a.objectstore.count(a.key);a.transaction.addEventListener("error",
function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.total=b.result;success(a)})},"get.database":n.get,"get.databases":function(a){var b=a.on_success;if(!1===S)return error(a);a.request=z.webkitGetDatabaseNames();a.request.addEventListener("success",function(c){a.databases=c.target.result;a.on_success=b;success(a)})},"get.store":function(a){success(a)},"get.stores":function(a){a.stores=a.db.objectStoreNames;success(a)},"get.index":function(a){a.idx=a.objectstore.index(a.index);
success(a)},"get.indexes":function(a){a.indexes=a.objectstore.indexNames;success(a)},"get.entry":function(a){var b;e(a.index)?(a.idx=a.objectstore.index(a.index),b=!1===a.value?a.idx.getKey(a.key):a.idx.get(a.key)):b=a.objectstore.get(a.key);a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)});b.addEventListener("success",function(){a.entry=b.result;success(a)})},"get.entries":function(a){a.type="readonly";var b=a.on_success;a.on_success=null;N(a,function(a){if(e(a.cursor)&&
(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"get.behaviors":w.get,"update.entries":function(a){a.type="readwrite";var b=a.on_success;N(a,function(a){if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor.update(a.data),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})},"put.entry":function(a){var b;a.data=q(a.data)?a.data():y(a.data);b=e(a.key)?a.objectstore.put(a.data,
a.key):a.objectstore.put(a.data);a.transaction.addEventListener("complete",function(){a.key=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)})},"clear.store":function(a){a.objectstore.clear();success(a)},"remove.database":n.remove,"remove.store":function(a){a.db.deleteObjectStore(a.store);success(a)},"remove.index":function(a){a.objectstore.deleteIndex(a.index);success(a)},"remove.entry":function(a){var b,c=e(a.range)||e(a.upper)||e(a.lower)||
e(a.only);b=a.objectstore["delete"](c?a.range||H.get(a):a.key);a.transaction.addEventListener("complete",function(){a.entry=b.result;success(a)});a.transaction.addEventListener("error",function(b){a.error=b.target.error.message;error(a)})},"remove.entries":function(a){a.type="readwrite";var b=a.on_success;N(a,function(a){a.entry=a.request;if(e(a.cursor)&&(a.on_success=b,a.entry=a.cursor.value,a.amount=a.amount||0,a.amount+=1,a.cursor["delete"](),success(a),e(a.cursor["continue"])))a.cursor["continue"]()})}});
!0===I&&u.addEventListener("message",function(a){var b=a.data,c=b.dash.split(".");a=c[0];var c=c[1],d=function(a){b.context=a;u.postMessage(b)};void 0!==dash[a]&&void 0!==dash[a][c]?F[a][c](b.context)(function(a){b.type="success";d(a)},function(a){b.type="error";d(a)},function(a){b.type="notify";d(a)}):(b.type="error",d({error:"No such method"}))},!1);return F}(self||{});